#!/bin/sh
echo "Running frontend checks..."
pnpm --filter mega-web lint

echo "Running python checks..."
./scripts/quality.sh

# Check for large files
git diff --cached --name-only --diff-filter=ACM | while IFS= read -r file; do
  if [ -f "$file" ]; then
    stat -f%z "$file" > .husky/.size_tmp
    read size < .husky/.size_tmp
    rm .husky/.size_tmp
    if [ "$size" -gt 104857600 ]; then
      echo "ERRO: Arquivo \"$file\" possui $size bytes (>100MB). Commit abortado."
      exit 1
    fi
  fi
done
